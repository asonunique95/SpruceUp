# Evergreen Library Automation

A PowerShell-based automation tool utilizing the `Evergreen` module to fetch, organize, and manage latest enterprise application installers locally.

## Features
- **Automated Version Tracking:** Checks `EvergreenLibrary.json` for new versions.
- **Publisher-Based Organization:** Downloads installers into a structured `<RootPath>\<Publisher>\<Application>\<Channel>\<Version>\<Architecture>` format.
- **Smart Sync:** Only downloads new or missing installers to save bandwidth and storage.
- **Resilient Downloads:** Built-in retry logic with exponential backoff for network failures.
- **Centralized Logging:** Tracks all sync activity in a CSV log file.

## Prerequisites
- Windows PowerShell 5.1 or PowerShell Core 7.x
- `Evergreen` PowerShell module (`Install-Module Evergreen -Scope CurrentUser`)

## Getting Started

### 1. Configure the Library (`EvergreenLibrary.json`)
Define the applications you want to track.
```json
{
  "Applications": [
    {
      "Name": "GoogleChrome",
      "Vendor": "Google",
      "EvergreenApp": "GoogleChrome",
      "Filter": "$_.Channel -eq 'Stable' -and $_.Architecture -eq 'x64' -and $_.Type -eq 'msi'"
    }
  ]
}
```

### 2. Run the Sync Script
Run the main script to synchronize your local library.
```powershell
.\Invoke-EvergreenLibrarySync.ps1 -LibraryPath "C:\Evergreen" -LogFile "EvergreenSyncLog.csv"
```

## Project Structure
- `Invoke-EvergreenLibrarySync.ps1`: The main entry point script.
- `Scripts/LibraryFunctions.ps1`: Core functions for parsing, version discovery, and downloading.
- `EvergreenLibrary.json`: Centralized application manifest.
- `EvergreenSyncLog.csv`: Log file generated by the sync process.
